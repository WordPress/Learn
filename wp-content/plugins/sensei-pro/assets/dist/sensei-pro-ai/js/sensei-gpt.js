(()=>{var e={4794:(e,t)=>{var n;!function(){"use strict";var s={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var l=r.apply(null,n);l&&e.push(l)}}else if("object"===o)if(n.toString===Object.prototype.toString)for(var a in n)s.call(n,a)&&n[a]&&e.push(a);else e.push(n.toString())}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},1900:(e,t,n)=>{var s=n(8510),r=n(6481),o=r;o.v1=s,o.v4=r,e.exports=o},6681:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var s=n||0,r=t;return[r[e[s++]],r[e[s++]],r[e[s++]],r[e[s++]],"-",r[e[s++]],r[e[s++]],"-",r[e[s++]],r[e[s++]],"-",r[e[s++]],r[e[s++]],"-",r[e[s++]],r[e[s++]],r[e[s++]],r[e[s++]],r[e[s++]],r[e[s++]]].join("")}},9094:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},8510:(e,t,n)=>{var s,r,o=n(9094),l=n(6681),a=0,i=0;e.exports=function(e,t,n){var c=t&&n||0,u=t||[],m=(e=e||{}).node||s,p=void 0!==e.clockseq?e.clockseq:r;if(null==m||null==p){var d=o();null==m&&(m=s=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==p&&(p=r=16383&(d[6]<<8|d[7]))}var _=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:i+1,h=_-a+(g-i)/1e4;if(h<0&&void 0===e.clockseq&&(p=p+1&16383),(h<0||_>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=_,i=g,r=p;var b=(1e4*(268435455&(_+=122192928e5))+g)%4294967296;u[c++]=b>>>24&255,u[c++]=b>>>16&255,u[c++]=b>>>8&255,u[c++]=255&b;var w=_/4294967296*1e4&268435455;u[c++]=w>>>8&255,u[c++]=255&w,u[c++]=w>>>24&15|16,u[c++]=w>>>16&255,u[c++]=p>>>8|128,u[c++]=255&p;for(var k=0;k<6;++k)u[c+k]=m[k];return t||l(u)}},6481:(e,t,n)=>{var s=n(9094),r=n(6681);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var l=(e=e||{}).random||(e.rng||s)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,t)for(var a=0;a<16;++a)t[o+a]=l[a];return t||r(l)}}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.element,t=window.wp.components,s=window.wp.i18n,r=window.React;var o;function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},l.apply(this,arguments)}function a(e){return r.createElement("svg",l({width:24,height:24,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),o||(o=r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.5 9.25a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zM10 13.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm4.75 3a.75.75 0 100-1.5.75.75 0 000 1.5z",fill:"#00594F"})))}const i=window.wp.hooks,c=window.wp.compose,u=window.wp.data,m=e=>{let t="";return e.forEach((e=>{let n=p(e);n=n?n+" ":"",e.innerBlocks&&e.innerBlocks.length>0&&(n+=m(e.innerBlocks)),t+=n})),t},p=e=>{const{attributes:t,name:n}=e;switch(n){case"core/paragraph":case"core/verse":case"core/preformatted":case"core/code":case"core/heading":case"core/freeform":case"core/list-item":return t.content;case"core/pullquote":return'"'+t.value+'" said '+t.citation+".";default:return""}},d=window.wp.apiFetch;var _=n.n(d);const g=window.wp.blocks,h=window.wp.blockEditor;function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},b.apply(this,arguments)}const w=t=>(0,c.createHigherOrderComponent)((n=>s=>(((t,n)=>{let{attributes:s,setMeta:r}=n;(0,e.useEffect)((()=>{const e=k(t(s));r({validationErrors:e})}),[t,s,r])})(t,s),(0,e.createElement)(n,s))),"withBlockValidation"),k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(e).filter((e=>{let[,t]=e;return t})).map((e=>{let[t]=e;return t}))};var v=n(4794),E=n.n(v);const f=(0,e.createContext)({}),y={correct:{title:(0,s.__)("Correct","sensei-pro"),placeholder:(0,s.__)("Show a message when the question is answered correctly. Type / to choose a block.","sensei-pro")},incorrect:{title:(0,s.__)("Incorrect","sensei-pro"),placeholder:(0,s.__)("Show a message when the question is answered incorrectly. Type / to choose a block.","sensei-pro")}},q=t=>{let{type:n}=t;const{title:s,placeholder:r}=y[n],o=(0,e.useContext)(f),{hideAnswerFeedback:l}=o.options;return l?"":(0,e.createElement)("div",{className:E()("sensei-lms-question__answer-feedback",`sensei-lms-question__answer-feedback--${n}`)},(0,e.createElement)("div",{className:"sensei-lms-question__answer-feedback__header"},(0,e.createElement)("span",{className:"sensei-lms-question__answer-feedback__icon"}),(0,e.createElement)("span",null,s)),(0,e.createElement)("div",{className:"sensei-lms-question__answer-feedback__content"},(0,e.createElement)(h.InnerBlocks,{template:[["core/paragraph",{placeholder:r}]],templateInsertUpdatesSelection:!1,templateLock:!1})))};var N,C;function B(){return B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},B.apply(this,arguments)}const A=function(e){return r.createElement("svg",B({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},e),N||(N=r.createElement("path",{d:"M12.408 7.277A2.999 2.999 0 009 10.25h1.5c0-.677.375-1.14.886-1.37.512-.228 1.11-.198 1.614.253.504.45.6 1.04.43 1.574-.171.534-.592.958-1.264 1.033l.021-.002a1.034 1.034 0 00-.937.99V14h1.5v-.95c1.02-.28 1.817-.979 2.107-1.888a2.998 2.998 0 00-2.449-3.885z"})),C||(C=r.createElement("path",{d:"M6 4c-1.096 0-2 .904-2 2v12c0 1.096.904 2 2 2h12c1.096 0 2-.904 2-2V6c0-1.096-.904-2-2-2H6zm0 1.5h12c.284 0 .5.216.5.5v12a.49.49 0 01-.5.5H6a.49.49 0 01-.5-.5V6c0-.284.216-.5.5-.5zm5.25 9.5v1.5h1.5V15h-1.5z"})))},x={parent:["sensei-lms/quiz-question"],category:"sensei-lms",supports:{html:!1},attributes:{id:{type:"integer"}}},S={...x,name:"sensei-lms/quiz-question-feedback-correct",title:(0,s.__)("Correct Answer Feedback","sensei-pro"),icon:A,description:(0,s.__)("Display correct answer feedback.","sensei-pro"),edit:e=>q({...e,type:"correct"}),save:()=>(0,e.createElement)(h.InnerBlocks.Content,null)},T={...x,name:"sensei-lms/quiz-question-feedback-incorrect",title:(0,s.__)("Incorrect Answer Feedback","sensei-pro"),icon:A,description:(0,s.__)("Display incorrect answer feedback.","sensei-pro"),edit:e=>q({...e,type:"incorrect"}),save:()=>(0,e.createElement)(h.InnerBlocks.Content,null)},F=window.lodash;var z,O;const M=((e,t)=>{if(u.createReduxStore){const n=(0,u.createReduxStore)(e,t);return(0,u.register)(n),n}return(0,u.registerStore)(e,t),e})("sensei/block-metadata",{reducer:(z={SET_BLOCK_META:(e,t)=>{let{clientId:n,metadata:s}=e;return{...t,[n]:{...t[n]||{},...s}}},CLEAR:(e,t)=>t?{...e,[t]:void 0}:{},DEFAULT:e=>e},O={},function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;const n=z[t.type]||z.DEFAULT;return n(t,e)}),actions:{setBlockMeta:(e,t)=>({type:"SET_BLOCK_META",clientId:e,metadata:t}),clear:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"CLEAR",clientId:e}}},selectors:{getBlockMeta:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n?e[t]?.[n]:e[t]},getMultipleBlockMeta:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=t?.length?(0,F.pick)(e,t):{...e};return n?(0,F.mapValues)(s,n):s}}}),I=(0,e.createContext)({}),P=t=>{const n=(0,u.useSelect)((e=>e(M).getBlockMeta(t)),[t]),{setBlockMeta:s}=(0,u.useDispatch)(M),r=R(),o=(0,e.useCallback)((e=>s(t,e)),[t,s]);return[(0,e.useMemo)((()=>({...r,...n})),[n,r]),o]},R=((0,c.createHigherOrderComponent)((t=>V((n=>{const[s]=P(n.clientId);return(0,e.createElement)(I.Provider,{value:s},(0,e.createElement)(t,n))}))),"withBlockMetaProvider"),()=>(0,e.useContext)(I)),V=(0,c.createHigherOrderComponent)((t=>n=>{const[s,r]=P(n.clientId);return(0,e.createElement)(t,b({},n,{meta:s,setMeta:r}))}),"withBlockMeta"),j=(0,c.compose)(V)((()=>{const t=(0,h.useBlockProps)({className:"sensei-lms-question-description-block"});return(0,e.createElement)("div",t,(0,e.createElement)(h.InnerBlocks,{template:[["core/paragraph",{placeholder:(0,s.__)("Add question description or type / to choose a block.","sensei-pro")}]],templateInsertUpdatesSelection:!1,templateLock:!1}))})),Q=JSON.parse('{"name":"sensei-lms/question-description","apiVersion":2,"title":"Description","description":"Question Description.","parent":["sensei-lms/quiz-question"],"category":"sensei-lms","textdomain":"sensei-lms","supports":{"html":false},"attributes":{"id":{"type":"integer"}}}'),D={...Q,metadata:Q,icon:A,usesContext:["sensei-lms/quizId"],edit:j,save:()=>(0,e.createElement)(h.InnerBlocks.Content,null)},L=function({icon:t,size:n=24,...s}){return(0,e.cloneElement)(t,{width:n,height:n,...s})},G=window.wp.primitives,W=(0,e.createElement)(G.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)(G.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),H=(0,e.createElement)(G.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)(G.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),U=()=>{const{answerFeedback:{showAnswerFeedback:t,toggleAnswerFeedback:n},options:{hideAnswerFeedback:r}}=(0,e.useContext)(f);return r?"":(0,e.createElement)("div",{className:E()("sensei-lms-question-block__answer-feedback-toggle",{"is-visible":t})},(0,e.createElement)("button",{className:"sensei-lms-question-block__answer-feedback-toggle__header",onClick:()=>n(!t)},(0,s.__)("Answer Feedback","sensei-pro"),(0,e.createElement)(L,{className:"sensei-lms-question-block__answer-feedback-toggle__icon",icon:t?W:H})),(0,e.createElement)("div",{className:"sensei-lms-question-block__answer-feedback-toggle__help"},(0,s.__)("Show feedback once the question is answered.","sensei-pro")))},K=JSON.parse('{"name":"sensei-lms/question-answers","apiVersion":2,"title":"Answers","description":"Question Answers.","parent":["sensei-lms/quiz-question"],"category":"sensei-lms","textdomain":"sensei-lms","supports":{"html":false},"attributes":{}}'),J={...K,metadata:K,icon:A,edit:()=>{const{answer:t,setAttributes:n,AnswerBlock:s,hasSelected:r,canHaveFeedback:o}=(0,e.useContext)(f),l=(0,h.useBlockProps)({className:"sensei-lms-question-answers-block"});return(0,e.createElement)("div",l,s?.edit&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.edit,{attributes:t,setAttributes:e=>n({answer:{...t,...e}}),hasSelected:r}),o&&r&&(0,e.createElement)(U,null)))},save:()=>(0,e.createElement)(h.InnerBlocks.Content,null)},$=e=>{const t=(0,u.useSelect)((t=>{const n=t("core/block-editor"),s=n.getBlockRootClientId(e);return(n.getBlocks(s)||[]).slice(0,n.getBlockIndex(e,s))}),[e]).reduce(((e,t)=>e+("category-question"===t.attributes.type&&t.attributes.options?.number||1)),0);return t+1},X=window.wp.keycodes,Y=(0,e.forwardRef)(((t,n)=>{let{onChange:s,onKeyDown:r,value:o,onEnter:l,onRemove:a,...i}=t;return(0,e.createElement)(h.PlainText,b({ref:n,value:o,onChange:e=>{s(e.replace(/\n/g,""))},onKeyDown:e=>{switch(r&&r(e),e.keyCode){case X.ENTER:e.preventDefault(),l&&l(e);break;case X.BACKSPACE:a&&!o?.length&&(e.preventDefault(),a())}}},i,{className:E()("sensei-lms-single-line-input",i.className)}))})),Z=Y,ee=t=>{let{onMount:n}=t;return(0,e.useEffect)((()=>{n()}),[n]),null},te=()=>(0,e.createElement)("div",{className:"wp-block-button is-style-outline sensei-lms-question-block__answer sensei-lms-question-block__answer--file-upload"},(0,e.createElement)("div",{className:"wp-block-button__link wp-element-button"},(0,s.__)("Choose File","sensei-pro"))),ne=n=>{let{attributes:{before:r,after:o,gap:l},setAttributes:a,hasSelected:i}=n;return(0,e.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--gap-fill"},(0,e.createElement)("li",null,(0,e.createElement)(Y,{className:"sensei-lms-question-block__answer--gap-fill__text",placeholder:(0,s.__)("Text before the gap","sensei-pro"),value:r,onChange:e=>a({before:e})})),(0,e.createElement)("li",{className:"sensei-lms-question-block__answer--gap-fill__right-answers",onBlur:e=>{let{target:t}=e;t?.value&&(a({gap:[...null!=l?l:[],t.value]}),re(t,""))}},(0,e.createElement)(t.FormTokenField,{className:"sensei-lms-question-block__text-input-placeholder",value:l||[],label:!1,onChange:e=>a({gap:e})}),i&&(0,e.createElement)("div",{className:"sensei-lms-question-block__answer--gap-fill__hint"},(0,s.__)("Add right answers. Separate with commas or the Enter key.","sensei-pro"))),(0,e.createElement)("li",null,(0,e.createElement)(Y,{className:"sensei-lms-question-block__answer--gap-fill__text",placeholder:(0,s.__)("Text after the gap","sensei-pro"),value:o,onChange:e=>a({after:e})})))};ne.view=t=>{let{attributes:{before:n,after:s,gap:r}}=t;return(0,e.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--gap-fill"},(0,e.createElement)("li",null,n),(0,e.createElement)("li",{className:"sensei-lms-question-block__answer--gap-fill__right-answers sensei-lms-question-block__text-input-placeholder"},r.map((t=>(0,e.createElement)("span",{key:t,className:"sensei-lms-question-block__answer--gap-fill__token"},t)))),(0,e.createElement)("li",null,s))};const se=ne,re=(e,t)=>{delete e.value,e.value=t,e.dispatchEvent(new window.Event("change",{bubbles:!0}))},oe=()=>(0,e.createElement)("div",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--multi-line"},(0,e.createElement)("div",{className:"sensei-lms-question-block__text-input-placeholder multi-line"})),le=(0,e.createElement)(G.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,e.createElement)(G.Path,{d:"M18.3 5.6L9.9 16.9l-4.6-3.4-.9 1.2 5.8 4.3 9.3-12.6z"})),ae=t=>{let{className:n,isChecked:s,isCheckbox:r,input:o,children:l,...a}=t;return(0,e.createElement)("div",b({className:E()("sensei-lms-question-block__option-toggle",n)},a),o,(0,e.createElement)("div",{className:E()("sensei-lms-question-block__option-toggle__control",{"is-checked":s,"is-checkbox":r})},r&&le),l)},ie=n=>{const{attributes:{label:r,correct:o},setAttributes:l,hasFocus:a,hasSelected:i,isCheckbox:c,...u}=n,m=(0,e.useRef)(null);return(0,e.useEffect)((()=>{a&&(m.current?.textarea||m.current)?.focus()}),[a,m]),(0,e.createElement)("div",{className:"sensei-lms-question-block__multiple-choice-answer-option"},(0,e.createElement)(ae,{isChecked:o,isCheckbox:c}),(0,e.createElement)(Z,b({ref:m,placeholder:(0,s.__)("Add Answer","sensei-pro"),className:"sensei-lms-question-block__multiple-choice-answer-option__input",onChange:e=>l({label:e}),value:r},u)),i&&(0,e.createElement)("div",{className:"sensei-lms-question-block__answer--multiple-choice__toggle__wrapper"},(0,e.createElement)(t.Button,{isPrimary:!0,className:"sensei-lms-question-block__answer--multiple-choice__toggle",onClick:()=>l({correct:!o})},o&&(0,s.__)("Right","sensei-pro"),!o&&(0,s.__)("Wrong","sensei-pro"))))},ce=[{label:"",correct:!0},{label:"",correct:!1}],ue=e=>e.filter((e=>e.correct)).length>1,me=t=>{const{setAttributes:n,hasSelected:s}=t;let{attributes:{answers:r=[]}}=t;0===r.length&&(r=ce);const o=ue(r),l=!r[r.length-1]?.label,a=[...r];s&&!l&&a.push({label:"",correct:!1});const[i,c]=(0,e.useState)(null);return(0,e.createElement)(me.Options,{answers:a},((t,l)=>(0,e.createElement)(ie,{hasFocus:l===i,isCheckbox:o,attributes:t,setAttributes:e=>((e,t)=>{{const s=[...r];s[e]={...s[e],...t},n({answers:s})}})(l,e),onEnter:()=>(e=>{const t=[...r];t.splice(e+1,0,{label:"",correct:!1}),n({answers:t}),c(e+1)})(l),onRemove:()=>(e=>{if(1===r.length)return;c(e-1);const t=[...r];t.splice(e,1),n({answers:t})})(l),hasSelected:s})))};me.Options=t=>{let{answers:n,children:s}=t;return(0,e.createElement)("ol",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--multiple-choice"},n.map(((t,n)=>(0,e.createElement)("li",{key:n,className:E()("sensei-lms-question-block__answer--multiple-choice__option",{"is-draft":!t.label})},s(t,n)))))},me.view=t=>{let{attributes:{answers:n=[]}}=t;const s=ue(n);return(0,e.createElement)(me.Options,{answers:n},(t=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(ae,{isChecked:t.correct,isCheckbox:s}),t.label)))};const pe=me,de=t=>{let{children:n}=t;return(0,e.createElement)("div",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--single-line"},(0,e.createElement)("small",{className:"sensei-lms-question-block__input-label"},(0,s.__)("Answer:","sensei-pro")),(0,e.createElement)("div",{className:"sensei-lms-question-block__text-input-placeholder"},n))},_e=n=>{let{attributes:{correct:r=!0},setAttributes:o,hasSelected:l}=n;const a=[{label:(0,s.__)("True","sensei-pro"),value:!0},{label:(0,s.__)("False","sensei-pro"),value:!1}];return(0,e.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--true-false"},a.map((n=>{let{label:a,value:i}=n;return(0,e.createElement)("li",{key:i,className:"sensei-lms-question-block__answer--true-false__option"},(0,e.createElement)(ae,{isChecked:r===i},(0,e.createElement)("span",null,a)),l&&(0,e.createElement)("div",{className:"sensei-lms-question-block__answer--multiple-choice__toggle__wrapper"},(0,e.createElement)(t.Button,{isPrimary:!0,className:"sensei-lms-question-block__answer--true-false__toggle",onClick:()=>o({correct:i===r?!i:i})},r===i&&(0,s.__)("Right","sensei-pro"),r!==i&&(0,s.__)("Wrong","sensei-pro"))))})))};_e.view=t=>{let{attributes:{correct:n=!0}}=t;const r=[{label:(0,s.__)("True","sensei-pro"),value:!0},{label:(0,s.__)("False","sensei-pro"),value:!1}];return(0,e.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--true-false"},r.map((t=>{let{label:s,value:r}=t;return(0,e.createElement)("li",{key:r,className:"sensei-lms-question-block__answer--true-false__option"},(0,e.createElement)(ae,{isChecked:n===r},(0,e.createElement)("span",null,s)))})))};const ge=_e,he=n=>{let{options:{teacherNotes:r},setOptions:o}=n;return(0,e.createElement)(t.TextareaControl,{label:(0,s.__)("Grading Notes","sensei-pro"),onChange:e=>o({teacherNotes:e}),value:r||"",help:(0,s.__)("Displayed to the teacher when grading the question.","sensei-pro")})};var be=n(1900);const we=n=>{let{className:r,id:o,label:l,value:a,help:i,allowReset:c=!1,resetLabel:u,onChange:m,suffix:p,hideLabelFromVision:d,..._}=n;return(0,e.createElement)(t.BaseControl,{id:o,label:l,help:i,hideLabelFromVision:d},(0,e.createElement)("div",{className:"sensei-number-control"},(0,e.createElement)("div",{className:"sensei-number-control__input-container"},(0,e.createElement)("input",b({className:E()("sensei-number-control__input components-text-control__input",r),type:"number",id:o,onChange:e=>{m(parseInt(e.target.value,10)||_.min||0)},value:null===a?"":a},_)),p&&(0,e.createElement)("span",{className:"sensei-number-control__input-suffix"},p)),c&&(0,e.createElement)(t.Button,{className:"sensei-number-control__button",isSmall:!0,isSecondary:!0,onClick:()=>m(null)},u||(0,s.__)("Reset","sensei-pro"))))},ke=t=>{const n=(0,e.useMemo)((()=>(0,be.v4)()),[]);return(0,e.createElement)(we,b({id:n,min:0,step:1},t,{suffix:(0,s._n)("Point","Points",t.value,"sensei-pro")}))},ve=t=>{let{options:{grade:n=1},setOptions:r}=t;return(0,e.createElement)(ke,{label:(0,s.__)("Grade","sensei-pro"),value:n,onChange:e=>r({grade:null!=e?e:1}),allowReset:!0})},Ee={"multiple-choice":{title:(0,s.__)("Multiple Choice","sensei-pro"),description:(0,s.__)("Select from a list of options.","sensei-pro"),edit:pe,view:pe.view,settings:[n=>{let{options:{randomOrder:r=!1},setOptions:o}=n;return(0,e.createElement)(t.CheckboxControl,{label:(0,s.__)("Random Order","sensei-pro"),checked:r,onChange:e=>o({randomOrder:e})})}],feedback:!0,validate:function(){let{answers:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{noAnswers:e.filter((e=>e.label)).length<2,noRightAnswer:!e.some((e=>e.correct&&e.label)),noRightAnswerWhitespace:!e.some((e=>e.correct&&e.label.trim())),noWrongAnswer:!e.some((e=>!e.correct&&e.label)),noWrongAnswerWhitespace:!e.some((e=>!e.correct&&e.label.trim()))}},messages:{noAnswers:(0,s.__)("Add at least one right and one wrong answer.","sensei-pro"),noRightAnswer:(0,s.__)("Add a right answer to this question.","sensei-pro"),noRightAnswerWhitespace:(0,s.__)("The value of the right answer can not be blank space.","sensei-pro"),noWrongAnswer:(0,s.__)("Add a wrong answer to this question. Value can not be blank space.","sensei-pro"),noWrongAnswerWhitespace:(0,s.__)("The value of the wrong answer can not be blank space.","sensei-pro")}},boolean:{title:(0,s.__)("True/False","sensei-pro"),description:(0,s.__)("Select whether a statement is true or false.","sensei-pro"),edit:ge,view:ge.view,feedback:!0,settings:[]},"gap-fill":{title:(0,s.__)("Gap Fill","sensei-pro"),description:(0,s.__)("Fill in the blank.","sensei-pro"),edit:se,view:se.view,feedback:!0,settings:[],validate:function(){let{before:e,after:t,gap:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{noGap:!n?.filter((e=>""!==e)).length,noGapWhitespace:!n?.filter((e=>""!==e.trim())).length,noBeforeAndNoAfter:!e&&!t,noBeforeAndNoAfterWhitespace:!e?.trim()&&!t?.trim()}},messages:{noGap:(0,s.__)("Add a right answer to this question.","sensei-pro"),noGapWhitespace:(0,s.__)("The value of a right answer can not be blank space.","sensei-pro"),noBeforeAndNoAfter:(0,s.__)("Add text before or after the gap. Value can not be blank space.","sensei-pro"),noBeforeAndNoAfterWhitespace:(0,s.__)("Value of the text before or after the gap can not be blank space.","sensei-pro")}},"single-line":{title:(0,s.__)("Single Line","sensei-pro"),description:(0,s.__)("Short answer to an open-ended question.","sensei-pro"),edit:de,view:de,settings:[he]},"multi-line":{title:(0,s.__)("Multi Line","sensei-pro"),description:(0,s.__)("Long answer to an open-ended question.","sensei-pro"),edit:oe,view:oe,settings:[he]},"file-upload":{title:(0,s.__)("File Upload","sensei-pro"),description:(0,s.__)("Upload a file or document.","sensei-pro"),edit:te,view:te,settings:[he]}},fe={QuestionGradingNotesSettings:he},ye=(0,i.applyFilters)("sensei-lms.Question.questionTypes",Ee,fe),qe=(0,e.createElement)(G.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,e.createElement)(G.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"}));var Ne,Ce;function Be(){return Be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Be.apply(this,arguments)}const Ae=function(e){return r.createElement("svg",Be({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},e),Ne||(Ne=r.createElement("path",{d:"M13 7h-2v6h2V7zm0 8h-2v2h2v-2z"})),Ce||(Ce=r.createElement("path",{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0z"})))},xe=()=>(0,e.createElement)("div",{className:"sensei-lms-question-block__notice"},(0,e.createElement)(L,{icon:qe}),(0,e.createElement)(t.Tooltip,{text:(0,s.__)("Any updates made to this question will also update it in any other quiz that includes it.","sensei-pro")},(0,e.createElement)("span",null,(0,s.__)("Shared Question","sensei-pro")))),Se=t=>{let{attributes:{type:n},meta:{validationErrors:s,showValidationErrors:r},getErrorMessages:o}=t;if(!r||!s?.length)return null;const l=o(s,n);return(0,e.createElement)(Te,{errors:l})},Te=n=>{let{errors:s=[]}=n;if(!s||!s.length)return null;const r=s[0];return(0,e.createElement)(t.Notice,{isDismissible:!1,status:"warning",className:"sensei-lms-block-validation-notice"},(0,e.createElement)(Ae,{className:"sensei-lms-block-validation-notice__icon"}),r)},Fe=n=>{let{value:s,onChange:r}=n;return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.ToolbarGroup,{className:"sensei-lms-question-block__grade-toolbar"},(0,e.createElement)(ke,{value:s,onChange:r})))},ze=(e,t)=>e.map((e=>ye?.[t]?.messages?.[e]||We.messages[e])),Oe=()=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(h.BlockControls,null,(0,e.createElement)(t.Toolbar,null,(0,e.createElement)(t.ToolbarButton,{disabled:!0},(0,s.__)("Locked","sensei-pro")))),(0,e.createElement)(h.InspectorControls,null,(0,e.createElement)(t.PanelBody,{title:(0,s.__)("Question Details","sensei-pro"),initialOpen:!0},(0,e.createElement)("div",null,(0,s.__)("You are not allowed to edit this question.","sensei-pro"))))),Me=t=>{let{clientId:n,attributes:{title:s,answer:r,editable:o},questionIndex:l,questionGrade:a,AnswerBlock:i}=t;const c=(0,u.useSelect)((e=>e("core/block-editor").getBlock(n)),[n]);return(0,e.createElement)("div",{className:"sensei-lms-question-block"},l,(0,e.createElement)("h2",{className:"sensei-lms-question-block__title"},s),a,(0,e.createElement)(e.RawHTML,null,(0,g.getBlockContent)(c)),i?.view&&(0,e.createElement)(i.view,{attributes:r}),!o&&(0,e.createElement)(Oe,null))},Ie=n=>{let{controls:r=[],attributes:{options:o={}},setAttributes:l,...a}=n;const i=e=>l({options:{...o,...e}});return(0,e.createElement)(h.InspectorControls,null,(0,e.createElement)(t.PanelBody,{title:(0,s.__)("Question settings","sensei-pro"),initialOpen:!0},[ve,...r].map((t=>(0,e.createElement)(t,b({key:t},a,{options:o,setOptions:i})))),(0,e.createElement)(t.ToggleControl,{label:(0,s.__)("Hide Answer Feedback","sensei-pro"),checked:"yes"===o.hideAnswerFeedback,onChange:e=>i({hideAnswerFeedback:e?"yes":""}),help:(0,s.__)("Do not show any feedback when the student answers this question.","sensei-pro")})))},Pe=n=>{let{options:s,optionsLabel:r,icon:o,value:l,onChange:a,toggleProps:i,getMenuItemProps:c,popoverProps:u,...m}=n;const p=s.find((e=>l===e.value));return(0,e.createElement)(t.Dropdown,b({className:"sensei-toolbar-dropdown",popoverProps:{isAlternate:!0,position:"bottom right left",focusOnMount:!0,...u,className:E()(u?.className,"sensei-toolbar-dropdown__popover")},renderToggle:n=>{let{isOpen:s,onToggle:r}=n;return(0,e.createElement)(t.Button,b({onClick:r,icon:o,"aria-expanded":s,"aria-haspopup":"true"},i,{children:i?.children?i.children(p):p?.label}))},renderContent:n=>{let{onClose:o}=n;return(0,e.createElement)(t.NavigableMenu,{role:"menu",stopNavigationEvents:!0},(0,e.createElement)(t.MenuGroup,{label:r},s.map((n=>{const s=n.value===p?.value,r=c?.(n);return(0,e.createElement)(t.MenuItem,b({key:n.value,role:"menuitemradio",isSelected:s,icon:s?le:null,className:E()("sensei-toolbar-dropdown__option",{"is-selected":s},r?.className),onClick:()=>{a(n.value),o()},children:n.label},r))}))))}},m))},Re=n=>{let{value:r,onSelect:o,options:l}=n;return(0,e.createElement)(t.Toolbar,{className:"sensei-lms-question-block__type-selector__toolbar"},(0,e.createElement)(Pe,{className:"sensei-lms-question-block__type-selector",label:(0,s.__)("Question Type","sensei-pro"),options:l,value:r,onChange:e=>o(e),optionsLabel:(0,s.__)("Question Type","sensei-pro"),popoverProps:{className:"sensei-lms-question-block__type-selector__popover"},toggleProps:{children:t=>(0,e.createElement)("b",null,t?.title)},getMenuItemProps:t=>{let n=(0,e.createElement)("div",null,(0,e.createElement)("strong",null," ",t.title),(0,e.createElement)("div",{className:"sensei-lms-question-block__type-selector__option__description"},t.description));n=(0,i.applyFilters)("senseiQuestionTypeToolbarOptionChildren",n,t);const s={};return s.children=n,t.disabled&&(s.onClick=()=>{}),s}}))},Ve=window.wp.editPost,je=n=>{const{meta:{validationErrors:r,showValidationErrors:o},setMeta:l}=n,a=(0,e.useCallback)((function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];l({showValidationErrors:e})}),[l]);if(function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const s=(0,u.useSelect)((e=>e("core/editor").isSavingPost()&&!e("core/editor").isAutosavingPost()));(0,e.useEffect)((()=>{s&&t()}),[s,...n])}((()=>a(!1)),[a]),!r?.length)return null;const i=(0,e.createElement)(t.Notice,{isDismissible:!1,status:"warning",className:"sensei-lms-quiz-block__pre-publish-validation__notice",actions:o?[]:[{label:(0,s.__)("View issues","sensei-pro"),onClick:()=>a(!0),className:"is-link"}]},(0,s.__)("This question is incomplete.","sensei-pro"));return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(Ve.PluginPostStatusInfo,null,i),(0,e.createElement)(Ve.PluginPrePublishPanel,{title:(0,s.__)("Validation","sensei-pro"),initialOpen:!0},(0,e.createElement)(ee,{onMount:a}),i,(0,e.createElement)("p",null,(0,s.__)("Incomplete questions added to a quiz won't be displayed to the student.","sensei-pro"))))};let Qe=Object.entries(ye).map((e=>{let[t,n]=e;return{...n,label:n.title,value:t}}));Qe=(0,i.applyFilters)("senseiQuestionTypeToolbarOptions",Qe);const De=(0,c.compose)(V,w((e=>{const{id:t,type:n,title:s,answer:r}=e,o=(n&&ye[n]).validate?.(r)||{},l=s?.length;return l||r||t?{noTitle:!l,...o}:{}})))((t=>{const{attributes:{title:n,type:r,answer:o={},options:l,shared:a,editable:i=!0},setAttributes:c,clientId:m,context:p}=t,{removeBlock:d,selectBlock:_}=(0,u.useDispatch)("core/block-editor"),g=(0,e.useCallback)((()=>{const e=(0,u.select)("core/block-editor").getBlocks(m);e.length&&_(e[0].clientId)}),[m,_]),w=$(m),k=r&&ye[r],v=k?.feedback,y=(e=>{let{isSelected:t,clientId:n}=e;return(0,u.useSelect)((e=>e("core/block-editor").hasSelectedInnerBlock(n,!0)),[n])||t})(t),q=p&&!("sensei-lms/quizId"in p),N=n||y||q,C=!q&&(0,e.createElement)("h2",{className:"sensei-lms-question-block__index"},w,"."),B=t.meta.showValidationErrors&&t.meta.validationErrors?.length,A=(0,e.createElement)("div",{className:"sensei-lms-question-block__grade grade"},(x=l.grade,// Translators: placeholder is the grade for the questions.
(0,s.sprintf)((0,s._n)("%d point","%d points",x,"sensei-pro"),x)));var x;const[F,z]=(0,e.useState)(!1),O=(0,e.useMemo)((()=>({answer:o,setAttributes:c,AnswerBlock:k,hasSelected:y,canHaveFeedback:v,answerFeedback:{showAnswerFeedback:F,toggleAnswerFeedback:z},options:l})),[k,o,y,c,F,v,l]),M=(0,e.useMemo)((()=>[[D.name,{}],[J.name,{}],...v?[[S.name,{}],[T.name,{}]]:[]]),[v]),I=(0,h.useBlockProps)({className:E()("sensei-lms-question-block",{"is-draft":!n,"is-invalid":B,"show-answer-feedback":F})});return i?(0,e.createElement)("div",I,(0,e.createElement)("div",{className:"sensei-lms-question-block__header"},C,q&&(0,e.createElement)(je,t),(0,e.createElement)("h2",{className:"sensei-lms-question-block__title"},(0,e.createElement)(Z,{placeholder:(0,s.__)("Question Title","sensei-pro"),value:n,onChange:e=>c({title:e}),onEnter:g,onRemove:()=>d(m)})),k.subtitle&&(0,e.createElement)(k.subtitle,{isQuestionSelected:y}),N&&A),y&&a&&(0,e.createElement)(xe,null),N&&(0,e.createElement)(f.Provider,{value:O},(0,e.createElement)(h.InnerBlocks,{template:M,templateInsertUpdatesSelection:!1,templateLock:"all",renderAppender:null})),(0,e.createElement)(Se,b({},t,{getErrorMessages:ze})),(0,e.createElement)(h.BlockControls,null,(0,e.createElement)(e.Fragment,null,(0,e.createElement)(Re,{value:r,onSelect:e=>c({type:e}),options:Qe}),(0,e.createElement)(Fe,{value:l.grade,onChange:e=>c({options:{...l,grade:e}})}))),(0,e.createElement)(Ie,b({controls:k?.settings},t))):(0,e.createElement)(Me,b({},t,{questionGrade:A,questionIndex:C,AnswerBlock:k}))})),Le=JSON.parse('{"name":"sensei-lms/quiz-question","title":"Question","apiVersion":2,"description":"The building block of all quizzes.","parent":["sensei-lms/quiz"],"category":"sensei-lms","textdomain":"sensei-lms","supports":{"html":false},"example":{"attributes":{"title":"What are power chords?","answer":{"answers":[{"label":"  A chord consisting of a root note of the chord and a 5th","correct":true},{"label":"  A chord playing on an electric guitar","correct":false}]}}},"attributes":{"id":{"type":"integer"},"title":{"type":"string"},"type":{"type":"string","default":"multiple-choice"},"answer":{"type":"object"},"options":{"type":"object","default":{"grade":1,"hideAnswerFeedback":""}},"editable":{"type":"boolean","default":true,"source":false}}}'),Ge=[{onProgrammaticCreation:!0,isEligible(e,t){let n=!0;return e.options?.answerFeedback&&(n=!0),t.map((e=>([D.name,S.name,T.name].includes(e.name)&&(n=!1),!0))),n},attributes:{...Le.attributes},migrate(e,t){const n=[];return n.push((0,g.createBlock)(D.name,{},t),(0,g.createBlock)(J.name,{})),e.options?.answerFeedback&&(n.push((0,g.createBlock)(S.name,{},[(0,g.createBlock)("core/paragraph",{content:e.options.answerFeedback})])),n.push((0,g.createBlock)(T.name,{},[(0,g.createBlock)("core/paragraph",{content:e.options.answerFeedback})]))),[{...e,options:(0,F.omit)(e.options,"answerFeedback")},n]},save:()=>(0,e.createElement)(h.InnerBlocks.Content,null)},{onProgrammaticCreation:!0,isEligible:e=>e.media||"file-upload"===e.type&&!!e.options?.studentHelp,attributes:{...Le.attributes,media:{type:"object"}},migrate(t,n){const s=[...n];return t.media&&s.push((t=>{switch(t.type){case"image":return(0,g.createBlock)("core/image",{id:t.id,url:t.url});case"audio":return(0,g.createBlock)("core/audio",{id:t.id,src:t.url});case"video":return(0,g.createBlock)("core/video",{id:t.id,src:t.url});default:const n=(0,e.createElement)("a",{href:t.url},t.title);return(0,g.createBlock)("core/paragraph",{content:(0,e.renderToString)(n)})}})(t.media)),"file-upload"===t.type&&t.options?.studentHelp&&s.push((0,g.createBlock)("core/paragraph",{content:t.options.studentHelp})),[{...(0,F.omit)(t,"media"),options:(0,F.omit)(t.options,"studentHelp")},s]},save:()=>(0,e.createElement)(h.InnerBlocks.Content,null)}],We={...Le,metadata:Le,icon:A,usesContext:["sensei-lms/quizId"],deprecated:Ge,edit:De,save:()=>(0,e.createElement)(h.InnerBlocks.Content,null),messages:{noTitle:(0,s.__)("Add a title to this question.","sensei-pro")}},He=()=>{const t=(0,u.useSelect)((e=>{const t=e("core").getEntityRecords("taxonomy","question-category",{per_page:-1});return null!=t?t:[]}),[]),n=(0,e.useMemo)((()=>(t||[]).map((e=>({...e,name:unescape(e.name)})))),[t]),s=(0,e.useMemo)((()=>(0,F.keyBy)(null!=n?n:[],"id")),[n]);return[n,e=>{var t;return!(!s||0===s.length)&&null!==(t=s[e])&&void 0!==t&&t}]},Ue=n=>{var r,o;let{attributes:{options:l={}},setAttributes:a}=n;const i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a({...t,options:{...l,...e}})},[c,u]=He(),[m,p]=(0,e.useState)(null),d=((t,n)=>{const[s,r]=(0,e.useState)({});return(0,e.useEffect)((()=>{t&&!s.hasOwnProperty(t)&&_()({path:`/wp/v2/questions?question-category=${t}`,method:"GET",parse:!1}).then((e=>{s[t]=+e.headers.get("X-WP-Total"),r({...s})})).catch((e=>{e.json().then((e=>n(e.message)))}))}),[t,s,n]),!!s.hasOwnProperty(t)&&s[t]})(l.category,p),g=[{value:"",label:""},...(c||[]).map((e=>({value:e.id,label:e.name})))];return(0,e.createElement)(h.InspectorControls,null,(0,e.createElement)(t.PanelBody,{title:(0,s.__)("Category Question Settings","sensei-pro"),initialOpen:!0},!g.length&&(0,e.createElement)(t.Notice,{status:"warning",isDismissible:!1},(0,s.__)("No question categories exist.","sensei-pro")),g.length>0&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.SelectControl,{label:(0,s.__)("Category","sensei-pro"),options:g,value:null!==(r=l.category)&&void 0!==r?r:"",onChange:e=>{var t;const n=u(+e);i({category:null!==(t=+e)&&void 0!==t?t:null},{categoryName:n?.name}),p(null)}}),(0,e.createElement)(we,{label:(0,s.__)("Number of Questions","sensei-pro"),min:1,step:1,value:null!==(o=l.number)&&void 0!==o?o:1,onChange:e=>e&&i({number:e||1})}),null!==m&&(0,e.createElement)(t.Notice,{status:"error",isDismissible:!1},(0,s.sprintf)(// translators: The underlying error message.
(0,s.__)("An error occurred while retrieving questions: %s","sensei-pro"),m)),!1!==d&&null===m&&l.number>d&&(0,e.createElement)(t.Notice,{status:"warning",isDismissible:!1},(0,s.sprintf)(// translators: Placeholder is number of questions in category.
(0,s._n)("The selected category has %d question.","The selected category has %d questions.",d,"sensei-pro"),d)))))},Ke=e=>e.map((e=>Xe.messages[e])),Je=(0,c.compose)(V,w((e=>{const{options:t}=e;return{noCategory:!(t?.category>0)}})))((t=>{var n;const{attributes:{options:{number:r=1,category:o}},clientId:l,setAttributes:a}=t,i=$(l),[,c]=He(),u=r&&1!==r?`${i} - ${i+r-1}`:i,m=(0,e.createElement)("h2",{className:"sensei-lms-question-block__index"},u,"."),p=null!==(n=c(o)?.name)&&void 0!==n?n:t.attributes.categoryName,d=p===t.attributes.categoryName;return(0,e.useEffect)((()=>{p&&!d&&a({categoryName:p})}),[p,d,a]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(Ue,t),(0,e.createElement)("div",{className:"sensei-lms-question-block sensei-lms-category-question-block "+(o?"":"is-draft")},m,(0,e.createElement)("h2",{className:"sensei-lms-question-block__title"},p?(0,e.createElement)("strong",null,p):(0,s.__)("Category Question","sensei-pro"),p&&r>0&&" ("+(0,s.sprintf)(// translators: placeholder is number of questions to show from category.
(0,s._n)("%d question","%d questions",r,"sensei-pro"),r)+")")),(0,e.createElement)(Se,b({},t,{getErrorMessages:Ke})))})),$e=JSON.parse('{"name":"sensei-lms/quiz-category-question","title":"Category Question","description":"Pull questions from a question category.","parent":["sensei-lms/quiz"],"category":"sensei-lms","textdomain":"sensei-lms","supports":{"html":false},"attributes":{"id":{"type":"integer"},"type":{"type":"string","default":"category-question"},"categoryName":{"type":"string"},"options":{"type":"object","default":{"category":null,"number":1}}}}'),Xe={...$e,metadata:$e,icon:A,usesContext:["sensei-lms/quizId"],example:{attributes:{categoryName:(0,s.__)("Example Category","sensei-pro")}},edit:Je,save:()=>(0,e.createElement)(h.InnerBlocks.Content,null),messages:{noCategory:(0,s.__)("Assign a category to this question.","sensei-pro")}},Ye=e=>{const t=e.length&&e[e.length-1];return!t||("category-question"===(n=t.attributes).type?n.options.category:n.title)?e.length:e.length-1;var n},Ze=()=>{const{insertBlock:t,updateBlockAttributes:n}=(0,u.useDispatch)("core/block-editor"),[r,o]=(0,e.useState)(!1),[l,a]=(0,e.useState)(null),[i,c]=(0,e.useState)(3),{createErrorNotice:m}=(0,u.useDispatch)("core/notices"),[p,d]=(0,e.useState)(!1),[h,b]=(0,e.useState)(""),[w,k]=(0,e.useState)(!1),v=(0,u.useSelect)((e=>{const t=e("sensei/quiz-structure").getBlock();return e("core/block-editor").getBlock(t)}),[]);return(0,e.useEffect)((()=>{v&&Ye(v.innerBlocks)>0!==p&&d(!p)})),(0,e.useEffect)((()=>{l&&i&&(async()=>{o(!0);try{let e=await(async(e,t)=>_()({method:"POST",path:"/sensei-pro-ai/v1/gpt/questions",parse:!1,data:{text:e,count:t}}))(l,i);if(e=await e.json(),!e||!e.questions)throw new Error((0,s.__)("Unexpected error. Try again later.","sensei-pro"));const r=e.questions;let c=Ye(v.innerBlocks);r&&r.forEach((e=>{((e,t,n,s,r)=>{const o=(0,g.createBlock)(We.name,{title:e.question,answer:{answers:e.answers.map(((t,n)=>({label:t,correct:n===e.correct_answer_index})))}});n(o,t,s,!0),((e,t,n,s,r)=>{setTimeout((async()=>{(0,u.select)("core/block-editor").getBlocks(s).forEach((n=>{["sensei-lms/quiz-question-feedback-correct","sensei-lms/quiz-question-feedback-incorrect"].includes(n.name)&&r(n.innerBlocks[0].clientId,{content:"sensei-lms/quiz-question-feedback-correct"===n.name?e:t})}))}),0)})(e.correct_answer_explanation,e.nudge_towards_correct_answer,0,o.clientId,r)})(e,c++,t,v.clientId,n)}))}catch(e){et(e,m,b,k)}finally{o(!1),a(null)}})()}),[l,i]),{isBusy:r,generateQuizQuestions:(e,t)=>{a(e),c(t)},limitErrorMessage:h,disabledByTimeout:w,hasQuestions:p}},et=async(e,t,n,r)=>{if(e.status&&429===e.status)return n(await e.json()),r(!0),void setTimeout((()=>{r(!1)}),3e5);const o=(0,s.__)("Sorry could not generate questions","sensei-pro");let l=null;e instanceof Error?l=e.message:e instanceof Response&&(l=await e.json()),t(l||o,{type:"snackbar"})},tt=n=>r=>{const{isBusy:o,generateQuizQuestions:l,limitErrorMessage:i,disabledByTimeout:c,hasQuestions:p}=Ze(),[d,_]=(0,e.useState)(!1),[g,h]=(0,e.useState)(!0),[b,w]=(0,e.useState)(!1),{user:k}=(0,u.useSelect)((e=>({user:e("core").getCurrentUser()})));return(0,e.useEffect)((()=>{k&&k.meta&&k.meta.sensei_pro_question_ai_used&&h(!1)}),[k]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.Fill,{name:"SenseiQuizHeader"},(0,e.createElement)(t.Button,{variant:"secondary",onClick:()=>{w(g),g&&h(!1);const e=m((0,u.select)("core/block-editor").getBlocks().filter((e=>"sensei-lms/quiz"!==e.name))).trim();l(e,3),_(!0)},className:"sensei-pro-ai-generate-questions-button",disabled:o||p||c},(0,e.createElement)("div",{className:"button-text-content"},(0,e.createElement)(a,null),(0,s.__)("Generate quiz questions with AI","sensei-pro")))),o&&(0,e.createElement)(t.Fill,{name:"SenseiQuizBlockTop"},(0,e.createElement)("div",{className:"sensei-pro-quiz-question-generate-loader"},(0,e.createElement)(t.Spinner,null))),c&&d&&(0,e.createElement)(t.Fill,{name:"SenseiQuizBlockTop"},(0,e.createElement)(t.Notice,{className:"sensei-pro-quiz-question-generate-notice",dismissible:!1,onDismiss:()=>{_(!1)},status:"warning"},i)),b&&(0,e.createElement)(t.Fill,{name:"SenseiQuizBlockTop"},(0,e.createElement)(t.Notice,{className:"sensei-pro-quiz-question-generate-notice",dismissible:!1,onDismiss:()=>{w(!1)},status:"info"},(0,s.__)("Using AI can feel like magic. But make sure to double check the text and make changes as you see fit.","sensei-pro"))),(0,e.createElement)(n,r))};(0,i.addFilter)("blocks.registerBlockType","sensei-lms/with-chat-gpt-question-generator",(e=>"sensei-lms/quiz"!==e.name?e:{...e,edit:(0,c.compose)(tt)(e.edit)}))})()})();